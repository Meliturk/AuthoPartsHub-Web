@model List<AutoPartsWeb.Models.Part>
@{
    ViewData["Title"] = "Ürünlerim";
    Layout = "_SellerLayout";
}

<div class="d-flex align-items-center justify-content-between mb-3 flex-wrap gap-2">
    <div>
        <h3 class="fw-bold mb-0">Ürünlerim</h3>
        <div class="text-secondary small">Toplam @Model.Count kayıt</div>
    </div>
    <a class="btn btn-accent" asp-action="CreatePart"><i class="bi bi-plus-circle me-2"></i>Yeni Ürün</a>
    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success mt-2 w-100">@TempData["Success"]</div>
    }
</div>

<div class="table-responsive card border-0 shadow-sm rounded-4">
    <table class="table align-middle mb-0">
        <thead class="text-secondary small">
            <tr>
                <th>Görsel</th>
                <th>Ürün</th>
                <th>Kategori</th>
                <th class="text-end">Fiyat</th>
                <th class="text-end">Stok</th>
                <th class="text-end">İşlemler</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var p in Model)
            {
                <tr>
                    <td style="width:80px;">
                        @if (!string.IsNullOrWhiteSpace(p.ImageUrl))
                        {
                            <img src="@p.ImageUrl" alt="@p.Name" class="img-fluid rounded" style="height:64px; width:64px; object-fit:cover;" />
                        }
                        else
                        {
                            <div class="bg-light border rounded d-flex align-items-center justify-content-center" style="height:64px; width:64px;">
                                <i class="bi bi-image text-secondary"></i>
                            </div>
                        }
                    </td>
                    <td class="fw-semibold">@p.Name</td>
                    <td>@p.Category</td>
                    <td class="text-end">@p.Price.ToString("C0")</td>
                    <td class="text-end">
                        <div class="d-flex justify-content-end align-items-center gap-2">
                            <form asp-controller="Seller" asp-action="AdjustPartStock" method="post" class="d-inline">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="id" value="@p.Id" />
                                <input type="hidden" name="delta" value="-1" />
                                <button class="btn btn-sm btn-outline-danger" title="Stok azalt (-1)">-</button>
                            </form>
                            <span class="fw-semibold">@p.Stock</span>
                            <form asp-controller="Seller" asp-action="AdjustPartStock" method="post" class="d-inline">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="id" value="@p.Id" />
                                <input type="hidden" name="delta" value="1" />
                                <button class="btn btn-sm btn-outline-success" title="Stok artır (+1)">+</button>
                            </form>
                        </div>
                    </td>
                    <td class="text-end">
                        <a class="btn btn-sm btn-outline-secondary" asp-controller="Seller" asp-action="EditPart" asp-route-id="@p.Id">Düzenle</a>
                    </td>
                </tr>
            }
            @if (Model.Count == 0)
            {
                <tr><td colspan="6" class="text-center text-secondary py-4">Henüz ürün yok.</td></tr>
            }
        </tbody>
    </table>
</div>
